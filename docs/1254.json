{"@ID": "1254", "@Name": "Incorrect Comparison Logic Granularity", "@Abstraction": "Base", "@Structure": "Simple", "@Status": "Draft", "Description": "The product's comparison logic is performed over a series of steps rather than across the entire string in one operation. If there is a comparison logic failure on one of these steps, the operation may be vulnerable to a timing attack that can result in the interception of the process for nefarious purposes.", "Extended_Description": {"xhtml:p": "Comparison logic is used to compare a variety of objects including passwords, Message \n         Authentication Codes (MACs), and responses to verification challenges. When comparison logic is \n         implemented at a finer granularity (e.g., byte-by-byte comparison) and breaks in the case of a \n         comparison failure, an attacker can exploit this implementation to identify when exactly \n         the failure occurred. With multiple attempts, the attacker may be able to guesses the correct \n         password/response to challenge and elevate their privileges."}, "Related_Weaknesses": {"Related_Weakness": [{"@Nature": "ChildOf", "@CWE_ID": "208", "@View_ID": "1000", "@Ordinal": "Primary"}, {"@Nature": "ChildOf", "@CWE_ID": "697", "@View_ID": "1000"}]}, "Applicable_Platforms": {"Language": {"@Class": "Not Language-Specific", "@Prevalence": "Undetermined"}, "Operating_System": {"@Class": "Not OS-Specific", "@Prevalence": "Undetermined"}, "Architecture": {"@Class": "Not Architecture-Specific", "@Prevalence": "Undetermined"}, "Technology": {"@Class": "Not Technology-Specific", "@Prevalence": "Undetermined"}}, "Modes_Of_Introduction": {"Introduction": [{"Phase": "Architecture and Design"}, {"Phase": "Implementation"}]}, "Common_Consequences": {"Consequence": {"Scope": ["Confidentiality", "Authorization"], "Impact": "Bypass Protection Mechanism"}}, "Potential_Mitigations": {"Mitigation": {"Phase": "Implementation", "Description": {"xhtml:p": "The hardware designer should ensure that comparison logic is implemented so as to compare in one operation instead in smaller chunks."}}}, "Demonstrative_Examples": {"Demonstrative_Example": {"Intro_Text": "Consider an example hardware module that checks a user-provided password to grant access to a user. The user-provided password is compared against a golden value in a byte-by-byte manner.", "Example_Code": [{"@Nature": "Bad", "@Language": "Verilog", "xhtml:br": [null, null, null, null], "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null], "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null], "xhtml:div": [{"@style": "margin-left:1em;", "xhtml:br": [null, null], "#text": "assign check_pass[i] = 1;\n                    \t  continue;"}, {"@style": "margin-left:1em;", "xhtml:br": [null, null], "#text": "assign check_pass[i] = 0;\n                    \t  break;"}], "#text": "if (entered_pass[(i*8 - 1) : i] eq golden_pass([i*8 - 1) : i])\n\t\t\t\n                    \telse\n\t\t\t\n                    \tend"}, "#text": "assign check_pass[3:0] = 4'b0;\n                      for (i = 0; i < 4; i++) begin\n\t\t      \n                      assign grant_access = (check_pass == 4'b1111) ? 1'b1: 1'b0;"}, "#text": "always_comb @ (posedge clk)\n                    \n                    begin\n\t\t    \n                    end"}, {"@Nature": "Good", "xhtml:br": [null, null, null], "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null], "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null], "xhtml:div": [{"@style": "margin-left:1em;", "xhtml:br": [null, null], "#text": "assign check_pass[i] = 1;\n               \t\tcontinue;"}, {"@style": "margin-left:1em;", "xhtml:br": [null, null], "#text": "assign check_pass[i] = 0;\n               \t\tcontinue;"}], "#text": "if (entered_pass[(i*8 - 1) : i] eq golden_pass([i*8 -1) : i])\n\t\t      \n               \t      else\n\t\t      \n               \t      end"}, "#text": "assign check_pass[3:0] = 4'b0;\n               \t    for (i = 0; i < 4; i++) begin\n\t\t    \n               \t    assign grant_access = (check_pass == 4'b1111) ? 1'b1: 1'b0;"}, "#text": "always_comb @ (posedge clk)\n\t\t  begin\n\t\t  \n\t\t  end"}], "Body_Text": ["Since the code breaks on an incorrect entry of password, an attacker can guess the correct password for that byte-check iteration with few repeat attempts.", "To fix this weakness, either the comparison of the entire string should be done all at once, or the attacker is not given an indication whether pass or fail happened by allowing the comparison to run through all bits before the grant_access signal is set."]}}, "Observed_Examples": {"Observed_Example": [{"Reference": "CVE-2019-10482", "Description": "Smartphone OS uses comparison functions that are not in constant time, allowing side channels", "Link": "https://www.cve.org/CVERecord?id=CVE-2019-10482"}, {"Reference": "CVE-2014-0984", "Description": "Password-checking function in router terminates validation of a password entry when it encounters the first incorrect character, which allows remote attackers to obtain passwords via a brute-force attack that relies on timing differences in responses to incorrect password guesses, aka a timing side-channel attack.", "Link": "https://www.cve.org/CVERecord?id=CVE-2014-0984"}]}, "Related_Attack_Patterns": {"Related_Attack_Pattern": {"@CAPEC_ID": "26"}}, "References": {"Reference": {"@External_Reference_ID": "REF-1079"}}, "Content_History": {"Submission": {"Submission_Name": "Arun Kanuparthi, Hareesh Khattri, Parbati Kumar Manna, Narasimha Kumar V Mangipudi", "Submission_Organization": "Intel Corporation", "Submission_Date": "2020-02-12"}, "Modification": [{"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-08-20", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2021-07-20", "Modification_Comment": "updated Related_Attack_Patterns"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2022-10-13", "Modification_Comment": "updated Demonstrative_Examples"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated Observed_Examples, Relationships"}]}}