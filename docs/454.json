{"cwe": {"@ID": "454", "@Name": "External Initialization of Trusted Variables or Data Stores", "@Abstraction": "Base", "@Structure": "Simple", "@Status": "Draft", "Description": "The product initializes critical internal variables or data stores using inputs that can be modified by untrusted actors.", "Extended_Description": "A product system should be reluctant to trust variables that have been initialized outside of its trust boundary, especially if they are initialized by users. The variables may have been initialized incorrectly. If an attacker can initialize the variable, then they can influence what the vulnerable system will do.", "Related_Weaknesses": {"Related_Weakness": [{"@Nature": "ChildOf", "@CWE_ID": "665", "@View_ID": "1000", "@Ordinal": "Primary"}, {"@Nature": "CanAlsoBe", "@CWE_ID": "456", "@View_ID": "1000"}]}, "Applicable_Platforms": {"Language": [{"@Name": "PHP", "@Prevalence": "Sometimes"}, {"@Class": "Not Language-Specific", "@Prevalence": "Undetermined"}]}, "Modes_Of_Introduction": {"Introduction": [{"Phase": "Architecture and Design"}, {"Phase": "Implementation"}]}, "Common_Consequences": {"Consequence": {"Scope": "Integrity", "Impact": "Modify Application Data", "Note": "An attacker could gain access to and modify sensitive data or system information."}}, "Potential_Mitigations": {"Mitigation": [{"Phase": "Implementation", "Strategy": "Input Validation", "Description": "A product system should be reluctant to trust variables that have been initialized outside of its trust boundary. Ensure adequate checking (e.g. input validation) is performed when relying on input from outside a trust boundary."}, {"Phase": "Architecture and Design", "Description": "Avoid any external control of variables. If necessary, restrict the variables that can be modified using an allowlist, and use a different namespace or naming convention if possible."}]}, "Demonstrative_Examples": {"Demonstrative_Example": [{"Intro_Text": "In the Java example below, a system property controls the debug level of the application.", "Example_Code": {"@Nature": "Bad", "@Language": "Java", "xhtml:div": "int debugLevel = Integer.getInteger(\"com.domain.application.debugLevel\").intValue();"}, "Body_Text": "If an attacker is able to modify the system property, then it may be possible to coax the application into divulging sensitive information by virtue of the fact that additional debug information is printed/exposed as the debug level increases."}, {"Intro_Text": "This code checks the HTTP POST request for a debug switch, and enables a debug mode if the switch is set.", "Example_Code": {"@Nature": "Bad", "@Language": "PHP", "xhtml:div": {"xhtml:br": [null, null, null, null], "xhtml:div": [{"@style": "margin-left:1em;", "#text": "$debugEnabled = true;"}, {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null], "#text": "echo 'Debug Activated';phpinfo();$isAdmin = True;return True;"}, "#text": "if($debugEnabled){}"}], "xhtml:i": "/.../", "#text": "$debugEnabled = false;if ($_POST[\"debug\"] == \"true\"){}\n                     \n                     \n                     function login($username, $password){}"}}, "Body_Text": ["Any user can activate the debug mode, gaining administrator privileges. An attacker may also use the information printed by the phpinfo() function to further exploit the system. .", "This example also exhibits Information Exposure Through Debug Information (CWE-215)"]}]}, "Observed_Examples": {"Observed_Example": [{"Reference": "CVE-2000-0959", "Description": "Does not clear dangerous environment variables, enabling symlink attack.", "Link": "https://www.cve.org/CVERecord?id=CVE-2000-0959"}, {"Reference": "CVE-2001-0033", "Description": "Specify alternate configuration directory in environment variable, enabling untrusted path.", "Link": "https://www.cve.org/CVERecord?id=CVE-2001-0033"}, {"Reference": "CVE-2001-0872", "Description": "Dangerous environment variable not cleansed.", "Link": "https://www.cve.org/CVERecord?id=CVE-2001-0872"}, {"Reference": "CVE-2001-0084", "Description": "Specify arbitrary modules using environment variable.", "Link": "https://www.cve.org/CVERecord?id=CVE-2001-0084"}]}, "Taxonomy_Mappings": {"Taxonomy_Mapping": [{"@Taxonomy_Name": "PLOVER", "Entry_Name": "External initialization of trusted variables or values"}, {"@Taxonomy_Name": "Software Fault Patterns", "Entry_ID": "SFP25", "Entry_Name": "Tainted input to variable"}]}, "Notes": {"Note": [{"@Type": "Relationship", "#text": "Overlaps Missing variable initialization, especially in PHP."}, {"@Type": "Applicable Platform", "xhtml:p": "This is often found in PHP due to register_globals and the common practice of storing library/include files under the web document root so that they are available using a direct request."}]}, "Content_History": {"Submission": {"Submission_Name": "PLOVER", "Submission_Date": "2006-07-19"}, "Modification": [{"Modification_Name": "Sean Eidemiller", "Modification_Organization": "Cigital", "Modification_Date": "2008-07-01", "Modification_Comment": "added/updated demonstrative examples"}, {"Modification_Name": "Eric Dalci", "Modification_Organization": "Cigital", "Modification_Date": "2008-07-01", "Modification_Comment": "updated Potential_Mitigations, Time_of_Introduction"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2008-09-08", "Modification_Comment": "updated Applicable_Platforms, Description, Relationships, Other_Notes, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2009-10-29", "Modification_Comment": "updated Other_Notes, Relationship_Notes"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2010-02-16", "Modification_Comment": "updated Description, Name, Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2010-04-05", "Modification_Comment": "updated Applicable_Platforms, Demonstrative_Examples"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-03-29", "Modification_Comment": "updated Demonstrative_Examples"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-06-01", "Modification_Comment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-05-11", "Modification_Comment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-10-30", "Modification_Comment": "updated Potential_Mitigations"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2014-07-30", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2017-11-08", "Modification_Comment": "updated Description"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-06-25", "Modification_Comment": "updated Potential_Mitigations"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-01-31", "Modification_Comment": "updated Description, Potential_Mitigations"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated Relationships"}], "Previous_Entry_Name": [{"@Date": "2008-04-11", "#text": "External Initialization of Trusted Variables or Values"}, {"@Date": "2010-02-16", "#text": "External Initialization of Trusted Variables"}]}}, "copyright": "Copyright \u00a9 2006\u20132023, The MITRE Corporation. CWE, CWSS, CWRAF, and the CWE logo are trademarks of The MITRE Corporation.", "license": "CWE Usage: MITRE hereby grants you a non-exclusive, royalty-free license to use CWE for research, development, and commercial purposes. Any copy you make for such purposes is authorized on the condition that you reproduce MITRE\u2019s copyright designation and this license in any such copy."}