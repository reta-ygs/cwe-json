{"@ID": "62", "@Name": "UNIX Hard Link", "@Abstraction": "Variant", "@Structure": "Simple", "@Status": "Incomplete", "Description": "The product, when opening a file or directory, does not sufficiently account for when the name is associated with a hard link to a target that is outside of the intended control sphere. This could allow an attacker to cause the product to operate on unauthorized files.", "Extended_Description": "Failure for a system to check for hard links can result in vulnerability to different types of attacks. For example, an attacker can escalate their privileges if a file used by a privileged program is replaced with a hard link to a sensitive file (e.g. /etc/passwd). When the process opens the file, the attacker can assume the privileges of that process.", "Related_Weaknesses": {"Related_Weakness": {"@Nature": "ChildOf", "@CWE_ID": "59", "@View_ID": "1000", "@Ordinal": "Primary"}}, "Weakness_Ordinalities": {"Weakness_Ordinality": {"Ordinality": "Resultant"}}, "Applicable_Platforms": {"Language": {"@Class": "Not Language-Specific", "@Prevalence": "Undetermined"}, "Operating_System": {"@Class": "Unix", "@Prevalence": "Undetermined"}}, "Modes_Of_Introduction": {"Introduction": {"Phase": "Implementation"}}, "Common_Consequences": {"Consequence": {"Scope": ["Confidentiality", "Integrity"], "Impact": ["Read Files or Directories", "Modify Files or Directories"]}}, "Potential_Mitigations": {"Mitigation": {"@Mitigation_ID": "MIT-48.1", "Phase": "Architecture and Design", "Strategy": "Separation of Privilege", "Description": {"xhtml:p": ["Follow the principle of least privilege when assigning access rights to entities in a software system.", "Denying access to a file can prevent an attacker from replacing that file with a link to a sensitive file. Ensure good compartmentalization in the system to provide protected areas that can be trusted."]}}}, "Observed_Examples": {"Observed_Example": [{"Reference": "CVE-2001-1494", "Description": "Hard link attack, file overwrite; interesting because program checks against soft links", "Link": "https://www.cve.org/CVERecord?id=CVE-2001-1494"}, {"Reference": "CVE-2002-0793", "Description": "Hard link and possibly symbolic link following vulnerabilities in embedded operating system allow local users to overwrite arbitrary files.", "Link": "https://www.cve.org/CVERecord?id=CVE-2002-0793"}, {"Reference": "CVE-2003-0578", "Description": "Server creates hard links and unlinks files as root, which allows local users to gain privileges by deleting and overwriting arbitrary files.", "Link": "https://www.cve.org/CVERecord?id=CVE-2003-0578"}, {"Reference": "CVE-1999-0783", "Description": "Operating system allows local users to conduct a denial of service by creating a hard link from a device special file to a file on an NFS file system.", "Link": "https://www.cve.org/CVERecord?id=CVE-1999-0783"}, {"Reference": "CVE-2004-1603", "Description": "Web hosting manager follows hard links, which allows local users to read or modify arbitrary files.", "Link": "https://www.cve.org/CVERecord?id=CVE-2004-1603"}, {"Reference": "CVE-2004-1901", "Description": "Package listing system allows local users to overwrite arbitrary files via a hard link attack on the lockfiles.", "Link": "https://www.cve.org/CVERecord?id=CVE-2004-1901"}, {"Reference": "CVE-2005-0342", "Description": "The Finder in Mac OS X and earlier allows local users to overwrite arbitrary files and gain privileges by creating a hard link from the .DS_Store file to an arbitrary file.", "Link": "https://www.cve.org/CVERecord?id=CVE-2005-0342"}, {"Reference": "CVE-2005-1111", "Description": "Hard link race condition", "Link": "https://www.cve.org/CVERecord?id=CVE-2005-1111"}, {"Reference": "CVE-2021-21272", "Description": "\"Zip Slip\" vulnerability in Go-based Open Container Initiative (OCI) registries product allows writing arbitrary files outside intended directory via symbolic links or hard links in a gzipped tarball.", "Link": "https://www.cve.org/CVERecord?id=CVE-2021-21272"}, {"Reference": "BUGTRAQ:20030203 ASA-0001", "Description": "OpenBSD chpass/chfn/chsh file content leak", "Link": "http://www.securityfocus.com/archive/1/309962"}]}, "Taxonomy_Mappings": {"Taxonomy_Mapping": [{"@Taxonomy_Name": "PLOVER", "Entry_Name": "UNIX hard link"}, {"@Taxonomy_Name": "CERT C Secure Coding", "Entry_ID": "FIO05-C", "Entry_Name": "Identify files using multiple file attributes"}, {"@Taxonomy_Name": "Software Fault Patterns", "Entry_ID": "SFP18", "Entry_Name": "Link in resource name resolution"}]}, "References": {"Reference": {"@External_Reference_ID": "REF-62", "@Section": "Chapter 9, \"Hard Links\", Page 518"}}, "Content_History": {"Submission": {"Submission_Name": "PLOVER", "Submission_Date": "2006-07-19"}, "Modification": [{"Modification_Name": "Eric Dalci", "Modification_Organization": "Cigital", "Modification_Date": "2008-07-01", "Modification_Comment": "updated Time_of_Introduction"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2008-09-08", "Modification_Comment": "updated Applicable_Platforms, Relationships, Taxonomy_Mappings, Weakness_Ordinalities"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2008-10-14", "Modification_Comment": "updated Description"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2008-11-24", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-06-01", "Modification_Comment": "updated Common_Consequences"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-09-13", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-05-11", "Modification_Comment": "updated Observed_Examples, References, Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-10-30", "Modification_Comment": "updated Potential_Mitigations"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2014-07-30", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2017-11-08", "Modification_Comment": "updated Applicable_Platforms, Causal_Nature, Observed_Examples, Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-02-24", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2022-04-28", "Modification_Comment": "updated Research_Gaps"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2022-10-13", "Modification_Comment": "updated Observed_Examples"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-01-31", "Modification_Comment": "updated Description"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated Relationships"}]}}