{"cwe": {"@ID": "552", "@Name": "Files or Directories Accessible to External Parties", "@Abstraction": "Base", "@Structure": "Simple", "@Status": "Draft", "Description": "The product makes files or directories accessible to unauthorized actors, even though they should not be.", "Extended_Description": {"xhtml:p": ["Web servers, FTP servers, and similar servers may store a set of files underneath a \"root\" directory that is accessible to the server's users.  Applications may store sensitive files underneath this root without also using access control to limit which users may request those files, if any.  Alternately, an application might package multiple files or directories into an archive file (e.g., ZIP or tar), but the application might not exclude sensitive files that are underneath those directories.", "In cloud technologies and containers, this weakness might present itself in the form of misconfigured storage accounts that can be read or written by a public or anonymous user."]}, "Related_Weaknesses": {"Related_Weakness": [{"@Nature": "ChildOf", "@CWE_ID": "668", "@View_ID": "1000", "@Ordinal": "Primary"}, {"@Nature": "ChildOf", "@CWE_ID": "668", "@View_ID": "1003", "@Ordinal": "Primary"}, {"@Nature": "ChildOf", "@CWE_ID": "285", "@View_ID": "1000"}]}, "Applicable_Platforms": {"Language": {"@Class": "Not Language-Specific", "@Prevalence": "Undetermined"}, "Technology": [{"@Class": "Not Technology-Specific", "@Prevalence": "Undetermined"}, {"@Class": "Cloud Computing", "@Prevalence": "Often"}]}, "Modes_Of_Introduction": {"Introduction": [{"Phase": "Architecture and Design"}, {"Phase": "Implementation", "Note": "OMISSION: This weakness is caused by missing a security tactic during the architecture and design phase."}, {"Phase": "Operation", "Note": "OMISSION: This weakness is caused by missing a security tactic during the architecture and design phase."}]}, "Common_Consequences": {"Consequence": {"Scope": ["Confidentiality", "Integrity"], "Impact": ["Read Files or Directories", "Modify Files or Directories"]}}, "Detection_Methods": {"Detection_Method": {"@Detection_Method_ID": "DM-14", "Method": "Automated Static Analysis", "Description": "Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)", "Effectiveness": "High"}}, "Potential_Mitigations": {"Mitigation": {"Phase": ["Implementation", "System Configuration", "Operation"], "Description": "When storing data in the cloud (e.g., S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's controls to disable public access."}}, "Demonstrative_Examples": {"Demonstrative_Example": [{"@Demonstrative_Example_ID": "DX-160", "Intro_Text": "The following Azure command updates the settings for a storage account:", "Example_Code": [{"@Nature": "Bad", "@Language": "Shell", "xhtml:div": "az storage account update --name <storage-account> --resource-group <resource-group> --allow-blob-public-access true"}, {"@Nature": "Good", "@Language": "Shell", "xhtml:div": "az storage account update --name <storage-account> --resource-group <resource-group> --allow-blob-public-access false"}], "Body_Text": ["However, \"Allow Blob Public Access\" is set to true, meaning that anonymous/public users can access blobs.", "The command could be modified to disable \"Allow Blob Public Access\" by setting it to false."]}, {"@Demonstrative_Example_ID": "DX-161", "Intro_Text": "The following Google Cloud Storage command gets the settings for a storage account named 'BUCKET_NAME':", "Example_Code": [{"@Nature": "Informative", "@Language": "Shell", "xhtml:div": {"xhtml:br": null, "#text": "gsutil iam get gs://BUCKET_NAME"}}, {"@Nature": "bad", "@Language": "JSON", "xhtml:br": [null, null], "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null, null], "xhtml:div": [{"@style": "margin-left:1em;", "xhtml:br": [null, null, null], "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": null, "#text": "\"projectEditor: PROJECT-ID\",\n\t\t\t   \"projectOwner: PROJECT-ID\""}, "#text": "\"members\":[\n\t\t\t \n\t\t\t ],\n\t\t\t \"role\":\"roles/storage.legacyBucketOwner\""}, {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null, null], "#text": "\"allUsers\",\n\t\t\t   \"projectViewer: PROJECT-ID\"\n\t\t\t   ],\n\t\t\t   \"role\":\"roles/storage.legacyBucketReader\""}, "xhtml:br": null, "#text": "\"members\":[\n\t\t\t \n\t\t\t }"}], "#text": "\"bindings\":[{\n\t\t       \n\t\t       },\n\t\t       {\n\t\t       \n\t\t       ]"}, "#text": "{\n\t\t     \n\t\t     }"}, {"@Nature": "good", "@Language": "Shell", "xhtml:br": [null, null], "#text": "gsutil iam ch -d allUsers gs://BUCKET_NAME\n\t\t\t gsutil iam ch -d allAuthenticatedUsers gs://BUCKET_NAME"}], "Body_Text": ["Suppose the command returns the following result:", "This result includes the \"allUsers\" or IAM role added as members, causing this policy configuration to allow public access to cloud storage resources. There would be a similar concern if \"allAuthenticatedUsers\" was present.", "The command could be modified to remove \"allUsers\" and/or \"allAuthenticatedUsers\" as follows:"]}]}, "Affected_Resources": {"Affected_Resource": "File or Directory"}, "Taxonomy_Mappings": {"Taxonomy_Mapping": [{"@Taxonomy_Name": "OWASP Top Ten 2004", "Entry_ID": "A10", "Entry_Name": "Insecure Configuration Management", "Mapping_Fit": "CWE More Specific"}, {"@Taxonomy_Name": "CERT C Secure Coding", "Entry_ID": "FIO15-C", "Entry_Name": "Ensure that file operations are performed in a secure directory"}]}, "Related_Attack_Patterns": {"Related_Attack_Pattern": [{"@CAPEC_ID": "150"}, {"@CAPEC_ID": "639"}]}, "References": {"Reference": [{"@External_Reference_ID": "REF-1307", "@Section": "Section 3.7"}, {"@External_Reference_ID": "REF-1327", "@Section": "Section 5.1"}]}, "Content_History": {"Submission": {"Submission_Name": "CWE Community", "Submission_Date": "2006-07-19", "Submission_Comment": "Submitted by members of the CWE community to extend early CWE versions"}, "Modification": [{"Modification_Name": "Eric Dalci", "Modification_Organization": "Cigital", "Modification_Date": "2008-07-01", "Modification_Comment": "updated Time_of_Introduction"}, {"Modification_Organization": "Veracode", "Modification_Date": "2008-08-15", "Modification_Comment": "Suggested OWASP Top Ten 2004 mapping"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2008-09-08", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2008-11-24", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2009-07-27", "Modification_Comment": "updated Relationships"}, {"Modification_Organization": "Veracode", "Modification_Date": "2010-09-09", "Modification_Comment": "Suggested OWASP Top Ten mapping"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2010-09-27", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-06-01", "Modification_Comment": "updated Common_Consequences"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-09-13", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-05-11", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2014-07-30", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2015-12-07", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2017-01-19", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2017-11-08", "Modification_Comment": "updated Affected_Resources, Modes_of_Introduction, Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2019-01-03", "Modification_Comment": "updated Related_Attack_Patterns"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2019-06-20", "Modification_Comment": "updated Related_Attack_Patterns"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-02-24", "Modification_Comment": "updated Description, Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-08-20", "Modification_Comment": "updated Related_Attack_Patterns"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2021-10-28", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-01-31", "Modification_Comment": "updated Applicable_Platforms, Demonstrative_Examples, Description, Potential_Mitigations, References"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated Applicable_Platforms, Demonstrative_Examples, Description, Detection_Factors, References, Relationships, Time_of_Introduction"}], "Previous_Entry_Name": {"@Date": "2008-04-11", "#text": "Errant Files or Directories Accessible"}}}, "copyright": "Copyright \u00a9 2006\u20132023, The MITRE Corporation. CWE, CWSS, CWRAF, and the CWE logo are trademarks of The MITRE Corporation.", "license": "CWE Usage: MITRE hereby grants you a non-exclusive, royalty-free license to use CWE for research, development, and commercial purposes. Any copy you make for such purposes is authorized on the condition that you reproduce MITRE\u2019s copyright designation and this license in any such copy."}