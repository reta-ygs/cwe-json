{"cwe": {"@ID": "1314", "@Name": "Missing Write Protection for Parametric Data Values", "@Abstraction": "Base", "@Structure": "Simple", "@Status": "Draft", "Description": "The device does not write-protect the parametric data values for sensors that scale the sensor value, allowing untrusted software to manipulate the apparent result and potentially damage hardware or cause operational failure.", "Extended_Description": {"xhtml:p": ["Various sensors are used by hardware to detect any devices operating outside of the design limits. The threshold limit values are set by hardware fuses or trusted software such as the BIOS. These limits may be related to thermal, power, voltage, current, and frequency. Hardware mechanisms may be used to protect against alteration of the threshold limit values by untrusted software.", "The limit values are generally programmed in standard units for the type of value being read. However, the hardware-sensor blocks may report the settings in different units depending upon sensor design and operation. The raw sensor output value is converted to the desired units using a scale conversion based on the parametric data programmed into the sensor. The final converted value is then compared with the previously programmed limits.", "While the limit values are usually protected, the sensor parametric data values may not be. By changing the parametric data, safe operational limits may be bypassed."]}, "Related_Weaknesses": {"Related_Weakness": [{"@Nature": "ChildOf", "@CWE_ID": "862", "@View_ID": "1000", "@Ordinal": "Primary"}, {"@Nature": "PeerOf", "@CWE_ID": "1299", "@View_ID": "1194", "@Ordinal": "Primary"}]}, "Applicable_Platforms": {"Language": {"@Class": "Not Language-Specific", "@Prevalence": "Undetermined"}, "Operating_System": {"@Class": "Not OS-Specific", "@Prevalence": "Undetermined"}, "Architecture": {"@Class": "Not Architecture-Specific", "@Prevalence": "Undetermined"}, "Technology": {"@Name": "Sensor Hardware", "@Prevalence": "Undetermined"}}, "Modes_Of_Introduction": {"Introduction": [{"Phase": "Architecture and Design", "Note": "The lack of a requirement to protect parametric values may contribute to this weakness."}, {"Phase": "Implementation", "Note": "The lack of parametric value protection may be a cause of this weakness."}]}, "Common_Consequences": {"Consequence": {"Scope": "Availability", "Impact": ["Quality Degradation", "DoS: Resource Consumption (Other)"], "Likelihood": "High", "Note": "Sensor value manipulation, particularly thermal or power, may allow physical damage to occur or disabling of the device by a false fault shutdown causing a Denial-Of-Service."}}, "Potential_Mitigations": {"Mitigation": {"Phase": "Architecture and Design", "Description": "Access controls for sensor blocks should ensure that only trusted software is allowed to change threshold limits and sensor parametric data.", "Effectiveness": "High"}}, "Demonstrative_Examples": {"Demonstrative_Example": {"Intro_Text": {"xhtml:p": ["Malicious software executes instructions to increase power consumption to the highest possible level while causing the clock frequency to increase to its maximum value.\n\t\t\t\t\t\t\tSuch a program executing for an extended period of time would likely overheat the device, possibly resulting in permanent damage to the device.", "A ring, oscillator-based temperature sensor will generally report the sensed value as\n\t\t\t\t\t\t\toscillator frequency rather than degrees centigrade.  The temperature sensor will have\n\t\t\t\t\t\t\tcalibration values that are used to convert the detected frequency into the corresponding temperature in degrees centigrade.", "Consider a SoC design where the critical maximum temperature limit is set in fuse values to 100C and\n\t\t\t\t\t\t\tis not modifiable by software.  If the scaled thermal sensor output equals or exceeds this limit, the system is commanded to shut itself down.", "The thermal sensor calibration values are programmable through registers that are exposed to system software.\n\t\t\t\t\t\tThese registers allow software to affect the converted temperature output such that the output will never exceed the maximum temperature limit."]}, "Example_Code": [{"@Nature": "Bad", "@Language": "Other", "xhtml:p": ["The sensor frequency value is scaled by applying the function:", "where a and b are the programmable calibration data coefficients. Software sets a and b to zero ensuring the sensed\n\t\t\t\t\t\t\ttemperature is always zero."], "xhtml:div": {"@style": "margin-left:1em;", "#text": "Sensed Temp = a + b * Sensor Freq"}}, {"@Nature": "Good", "@Language": "Other", "xhtml:p": ["The sensor frequency value is scaled by applying the function:", "where a and b are the programmable calibration data coefficients. Untrusted software is prevented from changing the values of either a or b, \n\t\t\t\t\t\t\tpreventing this method of manipulating the temperature."], "xhtml:div": {"@style": "margin-left:1em;", "#text": "Sensed Temp = a + b * Sensor Freq"}}], "Body_Text": "This weakness may be addressed by preventing access to a and b."}}, "Observed_Examples": {"Observed_Example": {"Reference": "CVE-2017-8252", "Description": "Kernel can inject faults in computations during the execution of TrustZone leading to information disclosure in Snapdragon Auto, Snapdragon Compute, Snapdragon Connectivity, Snapdragon Consumer Electronics Connectivity, Snapdragon Consumer IOT, Snapdragon Industrial IOT, Snapdragon IoT, Snapdragon Mobile, Snapdragon Voice and Music, Snapdragon Wearables, Snapdragon Wired Infrastructure and Networking.", "Link": "https://www.cve.org/CVERecord?id=CVE-2017-8252"}}, "Related_Attack_Patterns": {"Related_Attack_Pattern": {"@CAPEC_ID": "1"}}, "References": {"Reference": {"@External_Reference_ID": "REF-1082"}}, "Content_History": {"Submission": {"Submission_Name": "Hareesh Khattri, Parbati K. Manna, and Arun Kanuparthi", "Submission_Organization": "The Intel Corporation", "Submission_Date": "2020-07-14"}, "Modification": [{"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2022-04-28", "Modification_Comment": "updated Applicable_Platforms"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2022-06-28", "Modification_Comment": "updated Applicable_Platforms"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated Relationships"}]}}, "copyright": "Copyright \u00a9 2006\u20132023, The MITRE Corporation. CWE, CWSS, CWRAF, and the CWE logo are trademarks of The MITRE Corporation.", "license": "CWE Usage: MITRE hereby grants you a non-exclusive, royalty-free license to use CWE for research, development, and commercial purposes. Any copy you make for such purposes is authorized on the condition that you reproduce MITRE\u2019s copyright designation and this license in any such copy."}