{"cwe": {"@ID": "778", "@Name": "Insufficient Logging", "@Abstraction": "Base", "@Structure": "Simple", "@Status": "Draft", "Description": "When a security-critical event occurs, the product either does not record the event or omits important details about the event when logging it.", "Extended_Description": {"xhtml:p": ["When security-critical events are not logged properly, such as a failed login attempt, this can make malicious behavior more difficult to detect and may hinder forensic analysis after an attack succeeds.", "As organizations adopt cloud storage resources, these technologies often require configuration changes to enable detailed logging information, since detailed logging can incur additional costs. This could lead to telemetry gaps in critical audit logs. For example, in Azure, the default value for logging is disabled."]}, "Related_Weaknesses": {"Related_Weakness": [{"@Nature": "ChildOf", "@CWE_ID": "223", "@View_ID": "1000", "@Ordinal": "Primary"}, {"@Nature": "ChildOf", "@CWE_ID": "693", "@View_ID": "1000"}]}, "Applicable_Platforms": {"Language": {"@Class": "Not Language-Specific", "@Prevalence": "Undetermined"}, "Technology": {"@Class": "Cloud Computing", "@Prevalence": "Undetermined"}}, "Modes_Of_Introduction": {"Introduction": {"Phase": "Operation", "Note": "COMMISSION: This weakness refers to an incorrect design related to an architectural security tactic."}}, "Likelihood_Of_Exploit": "Medium", "Common_Consequences": {"Consequence": {"Scope": "Non-Repudiation", "Impact": "Hide Activities", "Note": "If security critical information is not recorded, there will be no trail for forensic analysis and discovering the cause of problems or the source of attacks may become more difficult or impossible."}}, "Detection_Methods": {"Detection_Method": {"@Detection_Method_ID": "DM-14", "Method": "Automated Static Analysis", "Description": "Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)", "Effectiveness": "High"}}, "Potential_Mitigations": {"Mitigation": [{"Phase": "Architecture and Design", "Description": "Use a centralized logging mechanism that supports multiple levels of detail."}, {"Phase": "Implementation", "Description": "Ensure that all security-related successes and failures can be logged. When storing data in the cloud (e.g., AWS S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's controls to enable and capture detailed logging information."}, {"Phase": "Operation", "Description": "Be sure to set the level of logging appropriately in a production environment. Sufficient data should be logged to enable system administrators to detect attacks, diagnose errors, and recover from attacks. At the same time, logging too much data (CWE-779) can cause the same problems, including unexpected costs when using a cloud environment."}, {"Phase": "Operation", "Description": "To enable storage logging using Azure's Portal, navigate to the name of the Storage Account, locate Monitoring (CLASSIC) section, and select Diagnostic settings (classic). For each of the various properties (blob, file, table, queue), ensure the status is properly set for the desired logging data. If using PowerShell, the Set-AzStorageServiceLoggingProperty command could be called using appropriate -ServiceType, -LoggingOperations, and -RetentionDays arguments."}]}, "Demonstrative_Examples": {"Demonstrative_Example": [{"Intro_Text": "The example below shows a configuration for the service security audit feature in the Windows Communication Foundation (WCF).", "Example_Code": [{"@Nature": "Bad", "@Language": "XML", "xhtml:div": {"xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null, null], "#text": "<serviceSecurityAudit auditLogLocation=\"Default\"suppressAuditFailure=\"false\"serviceAuthorizationAuditLevel=\"None\"messageAuthenticationAuditLevel=\"None\" />"}, "#text": "<behavior name=\"NewBehavior\">..."}, "#text": "<serviceBehaviors>"}, "#text": "<behaviors>"}, "#text": "<system.serviceModel></system.serviceModel>"}}, {"@Nature": "Good", "@Language": "XML", "xhtml:div": {"xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null, null], "#text": "<serviceSecurityAudit auditLogLocation=\"Default\"suppressAuditFailure=\"false\"serviceAuthorizationAuditLevel=\"SuccessAndFailure\"messageAuthenticationAuditLevel=\"SuccessAndFailure\" />"}, "#text": "<behavior name=\"NewBehavior\">\n                              ..."}, "#text": "<serviceBehaviors>"}, "#text": "<behaviors>"}, "#text": "<system.serviceModel></system.serviceModel>"}}], "Body_Text": ["The previous configuration file has effectively disabled the recording of security-critical events, which would force the administrator to look to other sources during debug or recovery efforts.", "Logging failed authentication attempts can warn administrators of potential brute force attacks. Similarly, logging successful authentication events can provide a useful audit trail when a legitimate account is compromised. The following configuration shows appropriate settings, assuming that the site does not have excessive traffic, which could fill the logs if there are a large number of success or failure events (CWE-779)."]}, {"Intro_Text": "In the following Java example the code attempts to authenticate the user. If the login fails a retry is made. Proper restrictions on the number of login attempts are of course part of the retry functionality. Unfortunately, the failed login is not recorded and there would be no record of an adversary attempting to brute force the program.", "Example_Code": [{"@Nature": "Bad", "@Language": "Java", "xhtml:div": {"xhtml:div": [{"@style": "margin-left:1em;", "xhtml:br": null, "#text": "// Login successful\n\t\t     RunProgram();"}, {"@style": "margin-left:1em;", "xhtml:br": null, "#text": "// Login unsuccessful\n\t\t     LoginRetry();"}], "#text": "if LoginUser(){\n                     \n                  } else {\n                     \n                  }"}}, {"@Nature": "Good", "@Language": "Java", "xhtml:div": {"xhtml:div": [{"@style": "margin-left:1em;", "xhtml:br": [null, null], "#text": "// Login successful\n\t\t     log.warn(\"Login by user successful.\");\n\t\t     RunProgram();"}, {"@style": "margin-left:1em;", "xhtml:br": [null, null], "#text": "// Login unsuccessful\n\t\t       log.warn(\"Login attempt by user failed, trying again.\");\n\t\t     LoginRetry();"}], "#text": "if LoginUser(){\n                     \n                     } else {\n                     \n                  }"}}], "Body_Text": "It is recommended to log the failed login action. Note that unneutralized usernames should not be part of the log message, and passwords should never be part of the log message."}, {"Intro_Text": "Consider this command for updating Azure's Storage Logging for Blob service, adapted from [REF-1307]:", "Example_Code": [{"@Nature": "Bad", "@Language": "Shell", "xhtml:div": "az storage logging update --account-name --account-key --services b --log d --retention 90"}, {"@Nature": "Good", "@Language": "Shell", "xhtml:div": "az storage logging update --account-name --account-key --services b --log rwd --retention 90"}, {"@Nature": "Good", "@Language": "Shell", "xhtml:div": "Set-AzStorageServiceLoggingProperty -ServiceType Queue -LoggingOperations read,write,delete -RetentionDays 5 -Context $MyContextObject"}], "Body_Text": ["The \"--log d\" portion of the command says to log deletes. However, the argument does not include the logging of writes and reads. Adding the \"rw\" arguments to the -log parameter will fix the issue:", "To enable Azure's storage analytic logs programmatically using PowerShell:", "Notice that here, the retention has been limited to 5 days."]}]}, "Observed_Examples": {"Observed_Example": [{"Reference": "CVE-2008-4315", "Description": "server does not log failed authentication attempts, making it easier for attackers to perform brute force password guessing without being detected", "Link": "https://www.cve.org/CVERecord?id=CVE-2008-4315"}, {"Reference": "CVE-2008-1203", "Description": "admin interface does not log failed authentication attempts, making it easier for attackers to perform brute force password guessing without being detected", "Link": "https://www.cve.org/CVERecord?id=CVE-2008-1203"}, {"Reference": "CVE-2007-3730", "Description": "default configuration for POP server does not log source IP or username for login attempts", "Link": "https://www.cve.org/CVERecord?id=CVE-2007-3730"}, {"Reference": "CVE-2007-1225", "Description": "proxy does not log requests without \"http://\" in the URL, allowing web surfers to access restricted web content without detection", "Link": "https://www.cve.org/CVERecord?id=CVE-2007-1225"}, {"Reference": "CVE-2003-1566", "Description": "web server does not log requests for a non-standard request type", "Link": "https://www.cve.org/CVERecord?id=CVE-2003-1566"}]}, "References": {"Reference": [{"@External_Reference_ID": "REF-62", "@Section": "Chapter 2, \"Accountability\", Page 40"}, {"@External_Reference_ID": "REF-1307", "@Section": "Sections 3.5, 3.13, and 3.14"}, {"@External_Reference_ID": "REF-1308"}]}, "Content_History": {"Submission": {"Submission_Name": "CWE Content Team", "Submission_Organization": "MITRE", "Submission_Date": "2009-07-02"}, "Modification": [{"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-06-01", "Modification_Comment": "updated Common_Consequences"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-05-11", "Modification_Comment": "updated References"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2017-11-08", "Modification_Comment": "updated Modes_of_Introduction, Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2018-03-27", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-02-24", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-08-20", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2021-10-28", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2022-10-13", "Modification_Comment": "updated Demonstrative_Examples, Potential_Mitigations"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-01-31", "Modification_Comment": "updated Applicable_Platforms, Demonstrative_Examples, Description, Potential_Mitigations, References"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated Detection_Factors, Relationships"}], "Contribution": [{"@Type": "Content", "Contribution_Organization": "Fortify Software", "Contribution_Date": "2009-07-02", "Contribution_Comment": "Provided code example and additional information for description and consequences."}, {"@Type": "Content", "Contribution_Name": "Drew Buttner", "Contribution_Date": "2022-08-15", "Contribution_Comment": "Suggested a new demonstrative example and changes to the mitigations."}]}}, "copyright": "Copyright \u00a9 2006\u20132023, The MITRE Corporation. CWE, CWSS, CWRAF, and the CWE logo are trademarks of The MITRE Corporation.", "license": "CWE Usage: MITRE hereby grants you a non-exclusive, royalty-free license to use CWE for research, development, and commercial purposes. Any copy you make for such purposes is authorized on the condition that you reproduce MITRE\u2019s copyright designation and this license in any such copy."}