{"@ID": "1041", "@Name": "Use of Redundant Code", "@Abstraction": "Base", "@Structure": "Simple", "@Status": "Incomplete", "Description": "The product has multiple functions, methods, procedures, macros, etc. that\n\t\t\t\t\tcontain the same code.", "Extended_Description": {"xhtml:p": "This issue makes it more difficult to maintain the product, which indirectly affects security by making it more difficult or time-consuming to find and/or fix vulnerabilities.  For example, if there are two copies of the same code, the programmer might fix a weakness in one copy while forgetting to fix the same weakness in another copy."}, "Related_Weaknesses": {"Related_Weakness": {"@Nature": "ChildOf", "@CWE_ID": "710", "@View_ID": "1000", "@Ordinal": "Primary"}}, "Weakness_Ordinalities": {"Weakness_Ordinality": {"Ordinality": "Indirect"}}, "Applicable_Platforms": {"Language": {"@Class": "Not Language-Specific", "@Prevalence": "Undetermined"}}, "Common_Consequences": {"Consequence": {"Scope": "Other", "Impact": "Reduce Maintainability"}}, "Potential_Mitigations": {"Mitigation": {"Phase": "Implementation", "Description": "Merge common functionality into a single function and then call that function from across the entire code base."}}, "Demonstrative_Examples": {"Demonstrative_Example": {"Intro_Text": "In the following Java example the code performs some complex math when specific test conditions are met. The math is the same in each case and the equations are repeated within the code. Unfortunately if a future change needs to be made then that change needs to be made in all locations. This opens the door to mistakes being made and the changes not being made in the same way in each instance.", "Example_Code": [{"@Nature": "Bad", "@Language": "Java", "xhtml:div": {"xhtml:br": [null, null, null], "xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null, null, null, null, null, null, null], "xhtml:div": [{"@style": "margin-left:1em;", "xhtml:br": null, "#text": "// complex math equations\n                           surface_area = pi * r * s + pi * Math.pow(r, 2);"}, {"@style": "margin-left:1em;", "xhtml:br": null, "#text": "// a complex set of math\n                           surface_area = pi * r * s + pi * Math.pow(r, 2);"}], "#text": "double s = 10.0;\n                        double r = 1.0;\n                        double pi = 3.14159;\n                        double surface_area;\n                        if(r > 0.0) {\n                           \n                        }\n                        if(r > 1.0) {\n                           \n                        }"}, "xhtml:br": null, "#text": "public static void main(String[] args) {\n                        \n                     }"}, "#text": "public class Main {\n                     \n                  }"}}, {"@Nature": "Good", "@Language": "Java", "xhtml:div": {"xhtml:br": [null, null, null, null], "xhtml:div": [{"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null], "#text": "//complex math equations\n                        double pi = Math.PI;\n                        double surface_area = pi * r * s + pi * Math.pow(r, 2);\n                        return surface_area;"}, "xhtml:br": null, "#text": "private double ComplexMath(double r, double s) {\n                        \n                     }"}, {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null, null, null, null, null, null, null], "xhtml:div": [{"@style": "margin-left:1em;", "#text": "surface_area = ComplexMath(r, s);"}, {"@style": "margin-left:1em;", "#text": "surface_area = ComplexMath(r, s);"}], "#text": "double s = 10.0;\n                        double r = 1.0;\n                        double surface_area;\n                        if(r > 0.0) {\n                           \n                        }\n                        if(r > 1.0) {\n                           \n                        }"}, "xhtml:br": null, "#text": "public static void main(String[] args) {\n                        \n                     }"}], "#text": "public class Main {\n                     \n                     \n                  }"}}], "Body_Text": "It is recommended to place the complex math into its own function and then call that function whenever necessary."}}, "Taxonomy_Mappings": {"Taxonomy_Mapping": {"@Taxonomy_Name": "OMG ASCMM", "Entry_ID": "ASCMM-MNT-19"}}, "References": {"Reference": {"@External_Reference_ID": "REF-960", "@Section": "ASCMM-MNT-19"}}, "Content_History": {"Submission": {"Submission_Name": "CWE Content Team", "Submission_Organization": "MITRE", "Submission_Date": "2018-07-02", "Submission_Comment": "Entry derived from Common Quality Enumeration (CQE) Draft 0.9."}, "Modification": [{"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-08-20", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2022-10-13", "Modification_Comment": "updated Applicable_Platforms, Demonstrative_Examples, Potential_Mitigations"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-01-31", "Modification_Comment": "updated Description"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated References, Relationships"}], "Contribution": {"@Type": "Content", "Contribution_Name": "Drew Buttner", "Contribution_Date": "2022-08-15", "Contribution_Comment": "Suggested new demonstrative examples, mitigations, and applicable platforms."}}}