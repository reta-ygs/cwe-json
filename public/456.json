{"@ID": "456", "@Name": "Missing Initialization of a Variable", "@Abstraction": "Variant", "@Structure": "Simple", "@Status": "Draft", "Description": "The product does not initialize critical variables, which causes the execution environment to use unexpected values.", "Related_Weaknesses": {"Related_Weakness": [{"@Nature": "ChildOf", "@CWE_ID": "909", "@View_ID": "1000", "@Ordinal": "Primary"}, {"@Nature": "ChildOf", "@CWE_ID": "665", "@View_ID": "1305", "@Ordinal": "Primary"}, {"@Nature": "ChildOf", "@CWE_ID": "665", "@View_ID": "1340", "@Ordinal": "Primary"}, {"@Nature": "CanPrecede", "@CWE_ID": "89", "@View_ID": "1000"}, {"@Nature": "CanPrecede", "@CWE_ID": "120", "@View_ID": "1000"}, {"@Nature": "CanPrecede", "@CWE_ID": "98", "@View_ID": "1000"}, {"@Nature": "CanPrecede", "@CWE_ID": "457", "@View_ID": "1000"}]}, "Applicable_Platforms": {"Language": {"@Class": "Not Language-Specific", "@Prevalence": "Undetermined"}}, "Modes_Of_Introduction": {"Introduction": {"Phase": "Implementation"}}, "Common_Consequences": {"Consequence": {"Scope": ["Integrity", "Other"], "Impact": ["Unexpected State", "Quality Degradation", "Varies by Context"], "Note": "The uninitialized data may be invalid, causing logic errors within the program. In some cases, this could result in a security problem."}}, "Detection_Methods": {"Detection_Method": {"@Detection_Method_ID": "DM-14", "Method": "Automated Static Analysis", "Description": "Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)", "Effectiveness": "High"}}, "Potential_Mitigations": {"Mitigation": [{"Phase": "Implementation", "Description": "Check that critical variables are initialized."}, {"Phase": "Testing", "Description": "Use a static analysis tool to spot non-initialized variables."}]}, "Demonstrative_Examples": {"Demonstrative_Example": [{"Intro_Text": "This function attempts to extract a pair of numbers from a user-supplied string.", "Example_Code": [{"@Nature": "Bad", "@Language": "C", "xhtml:div": {"xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"xhtml:br": [null, null, null, null], "xhtml:div": {"@style": "margin-left:1em;", "#text": "die(\"Did not specify integer value. Die evil hacker!\\n\");"}, "xhtml:i": "/* proceed assuming n and m are initialized correctly */", "#text": "int m, n, error;error = sscanf(untrusted_input, \"%d:%d\", &m, &n);if ( EOF == error ){}"}}, "#text": "void parse_data(char *untrusted_input){}"}}, {"@Nature": "Attack", "xhtml:div": "123:"}], "Body_Text": ["This code attempts to extract two integer values out of a formatted, user-supplied input. However, if an attacker were to provide an input of the form:", "then only the m variable will be initialized. Subsequent use of n may result in the use of an uninitialized variable (CWE-457)."]}, {"Intro_Text": "Here, an uninitialized field in a Java class is used in a seldom-called method, which would cause a NullPointerException to be thrown.", "Example_Code": {"@Nature": "Bad", "@Language": "Java", "xhtml:div": {"xhtml:br": null, "xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"xhtml:br": [null, null, null, null, null], "xhtml:i": ["// Do something interesting.", "// Throws NPE if user hasn't been properly initialized."], "#text": "...\n                           \n                           \n                           String username = user.getName();"}}, "#text": "private User user;public void someMethod() {}"}}}, {"Intro_Text": "This code first authenticates a user, then allows a delete command if the user is an administrator.", "Example_Code": {"@Nature": "Bad", "@Language": "PHP", "xhtml:div": {"xhtml:div": [{"@style": "margin-left:1em;", "#text": "$isAdmin = true;"}, {"@style": "margin-left:1em;", "#text": "deleteUser($userToDelete);"}], "xhtml:br": [null, null, null], "xhtml:i": "/.../", "#text": "if (authenticate($username,$password) && setAdmin($username)){}\n                     \n                     \n                     if ($isAdmin){}"}}, "Body_Text": "The $isAdmin variable is set to true if the user is an admin, but is uninitialized otherwise. If PHP's register_globals feature is enabled, an attacker can set uninitialized variables like $isAdmin to arbitrary values, in this case gaining administrator privileges by setting $isAdmin to true."}, {"Intro_Text": "In the following Java code the BankManager class uses the user variable of the class User to allow authorized users to perform bank manager tasks. The user variable is initialized within the method setUser that retrieves the User from the User database. The user is then authenticated as unauthorized user through the method authenticateUser.", "Example_Code": [{"@Nature": "Bad", "@Language": "Java", "xhtml:div": {"xhtml:br": null, "xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"xhtml:br": [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null], "xhtml:i": ["// user allowed to perform bank manager tasks", "// constructor for BankManager class", "// retrieve user from database of users", "// set user variable using username", "// authenticate user", "// methods for performing bank manager tasks"], "xhtml:div": [{"@style": "margin-left:1em;", "#text": "..."}, {"@style": "margin-left:1em;", "#text": "..."}, {"@style": "margin-left:1em;", "#text": "this.user = getUserFromUserDatabase(username);"}, {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "#text": "isUserAuthentic = true;"}, "xhtml:br": null, "#text": "if (username.equals(user.getUsername()) && password.equals(user.getPassword())) {}return isUserAuthentic;"}], "#text": "private User user = null;private boolean isUserAuthentic = false;\n                           \n                           \n                           public BankManager() {}\n                           \n                           \n                           public User getUserFromUserDatabase(String username){}\n                           \n                           \n                           public void setUser(String username) {}\n                           \n                           \n                           public boolean authenticateUser(String username, String password) {}\n                           \n                           \n                           ..."}}, "#text": "public class BankManager {\n                     }"}}, {"@Nature": "Good", "@Language": "Java", "xhtml:div": {"xhtml:br": null, "xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"xhtml:br": [null, null, null, null, null, null, null, null, null, null, null, null, null, null], "xhtml:i": ["// user allowed to perform bank manager tasks", "// constructor for BankManager class", "// retrieve user from database of users", "// authenticate user"], "xhtml:div": [{"@style": "margin-left:1em;", "#text": "user = getUserFromUserDatabase(username);"}, {"@style": "margin-left:1em;", "xhtml:div": {"xhtml:div": [{"@style": "margin-left:1em;", "#text": "System.out.println(\"Cannot find user \" + username);"}, {"@style": "margin-left:1em;", "xhtml:div": {"@style": "margin-left:1em;", "#text": "isUserAuthentic = true;"}, "#text": "if (password.equals(user.getPassword())) {}"}], "xhtml:br": [null, null], "#text": "if (user == null) {}else {}return isUserAuthentic;"}}, {"@style": "margin-left:1em;", "xhtml:div": {"xhtml:br": [null, null], "xhtml:i": "// methods for performing bank manager tasks", "#text": "..."}}], "#text": "private User user = null;private boolean isUserAuthentic = false;\n                           \n                           \n                           public BankManager(String username) {}\n                           \n                           \n                           public User getUserFromUserDatabase(String username) {...}\n                           \n                           \n                           public boolean authenticateUser(String username, String password) {}"}}, "#text": "public class BankManager {\n                     }"}}], "Body_Text": "However, if the method setUser is not called before authenticateUser then the user variable will not have been initialized and will result in a NullPointerException. The code should verify that the user variable has been initialized before it is used, as in the following code."}, {"@Demonstrative_Example_ID": "DX-144", "Intro_Text": "This example will leave test_string in an\n\t\t\t  unknown condition when i is the same value as err_val,\n\t\t\t  because test_string is not initialized\n\t\t\t  (CWE-456). Depending on where this code segment appears\n\t\t\t  (e.g. within a function body), test_string might be\n\t\t\t  random if it is stored on the heap or stack. If the\n\t\t\t  variable is declared in static memory, it might be zero\n\t\t\t  or NULL. Compiler optimization might contribute to the\n\t\t\t  unpredictability of this address.", "Example_Code": [{"@Nature": "Bad", "@Language": "C", "xhtml:br": [null, null, null, null], "xhtml:div": {"@style": "margin-left:1em;", "#text": "test_string = \"Hello World!\";"}, "#text": "char *test_string;\n                if (i != err_val)\n                {\n                \n                }\n                printf(\"%s\", test_string);"}, {"@Nature": "Good", "@Language": "C", "xhtml:br": [null, null, null, null], "xhtml:div": {"@style": "margin-left:1em;", "#text": "test_string = \"Hello World!\";"}, "#text": "char *test_string = \"Done at the beginning\";\n\t\t\t\tif (i != err_val)\n\t\t\t\t{\n\t\t\t\t\n\t\t\t\t}\n\t\t\t\tprintf(\"%s\", test_string);"}, {"@Nature": "Good", "@Language": "C", "xhtml:br": [null, null, null, null, null, null], "xhtml:div": [{"@style": "margin-left:1em;", "#text": "test_string = \"Hello World!\";"}, {"@style": "margin-left:1em;", "#text": "test_string = \"Done on the other side!\";"}], "#text": "char *test_string;\n\t\t\t\tif (i != err_val)\n\t\t\t\t{\n\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\n\t\t\t\t}\n\t\t\t\tprintf(\"%s\", test_string);"}], "Body_Text": [{"xhtml:p": ["When the printf() is reached,\n              test_string might be an unexpected address, so the\n              printf might print junk strings (CWE-457).", "To fix this code, there are a couple approaches to\n\t\t\t  making sure that test_string has been properly set once\n\t\t\t  it reaches the printf().", "One solution would be to set test_string to an\n\t\t\t  acceptable default before the conditional:"]}, "Another solution is to ensure that each\n\t\t\t  branch of the conditional - including the default/else\n\t\t\t  branch - could ensure that test_string is set:"]}]}, "Observed_Examples": {"Observed_Example": [{"Reference": "CVE-2020-6078", "Description": "Chain: The return value of a function returning a pointer is not checked for success (CWE-252) resulting in the later use of an uninitialized variable (CWE-456) and a null pointer dereference (CWE-476)", "Link": "https://www.cve.org/CVERecord?id=CVE-2020-6078"}, {"Reference": "CVE-2009-2692", "Description": "Chain: Use of an unimplemented network socket operation pointing to an uninitialized handler function (CWE-456) causes a crash because of a null pointer dereference (CWE-476).", "Link": "https://www.cve.org/CVERecord?id=CVE-2009-2692"}, {"Reference": "CVE-2020-20739", "Description": "A variable that has its value set in a conditional statement is sometimes used when the conditional fails, sometimes causing data leakage", "Link": "https://www.cve.org/CVERecord?id=CVE-2020-20739"}, {"Reference": "CVE-2005-2978", "Description": "Product uses uninitialized variables for size and index, leading to resultant buffer overflow.", "Link": "https://www.cve.org/CVERecord?id=CVE-2005-2978"}, {"Reference": "CVE-2005-2109", "Description": "Internal variable in PHP application is not initialized, allowing external modification.", "Link": "https://www.cve.org/CVERecord?id=CVE-2005-2109"}, {"Reference": "CVE-2005-2193", "Description": "Array variable not initialized in PHP application, leading to resultant SQL injection.", "Link": "https://www.cve.org/CVERecord?id=CVE-2005-2193"}]}, "Taxonomy_Mappings": {"Taxonomy_Mapping": [{"@Taxonomy_Name": "PLOVER", "Entry_Name": "Missing Initialization"}, {"@Taxonomy_Name": "Software Fault Patterns", "Entry_ID": "SFP1", "Entry_Name": "Glitch in computation"}, {"@Taxonomy_Name": "CERT C Secure Coding", "Entry_ID": "ERR30-C", "Entry_Name": "Set errno to zero before calling a library function known to set errno,  and check errno only after the function returns a value indicating failure", "Mapping_Fit": "CWE More Abstract"}, {"@Taxonomy_Name": "SEI CERT Perl Coding Standard", "Entry_ID": "DCL04-PL", "Entry_Name": "Always initialize local variables", "Mapping_Fit": "Exact"}, {"@Taxonomy_Name": "SEI CERT Perl Coding Standard", "Entry_ID": "DCL33-PL", "Entry_Name": "Declare identifiers before using them", "Mapping_Fit": "Imprecise"}, {"@Taxonomy_Name": "OMG ASCSM", "Entry_ID": "ASCSM-CWE-456"}, {"@Taxonomy_Name": "OMG ASCRM", "Entry_ID": "ASCRM-CWE-456"}]}, "References": {"Reference": [{"@External_Reference_ID": "REF-62", "@Section": "Chapter 7, \"Variable Initialization\", Page 312"}, {"@External_Reference_ID": "REF-961", "@Section": "ASCRM-CWE-456"}, {"@External_Reference_ID": "REF-962", "@Section": "ASCSM-CWE-456"}]}, "Notes": {"Note": [{"@Type": "Relationship", "#text": "This weakness is a major factor in a number of resultant weaknesses, especially in web applications that allow global variable initialization (such as PHP) with libraries that can be directly requested."}, {"@Type": "Research Gap", "#text": "It is highly likely that a large number of resultant weaknesses have missing initialization as a primary factor, but researcher reports generally do not provide this level of detail."}]}, "Content_History": {"Submission": {"Submission_Name": "PLOVER", "Submission_Date": "2006-07-19"}, "Modification": [{"Modification_Name": "Sean Eidemiller", "Modification_Organization": "Cigital", "Modification_Date": "2008-07-01", "Modification_Comment": "added/updated demonstrative examples"}, {"Modification_Name": "Eric Dalci", "Modification_Organization": "Cigital", "Modification_Date": "2008-07-01", "Modification_Comment": "updated Potential_Mitigations, Time_of_Introduction"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2008-09-08", "Modification_Comment": "updated Relationships, Other_Notes, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2010-02-16", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2010-04-05", "Modification_Comment": "updated Applicable_Platforms, Demonstrative_Examples"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2010-06-21", "Modification_Comment": "updated Other_Notes, Relationship_Notes"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-03-29", "Modification_Comment": "updated Demonstrative_Examples"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-06-01", "Modification_Comment": "updated Common_Consequences"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-06-27", "Modification_Comment": "updated Common_Consequences, Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-05-11", "Modification_Comment": "updated References, Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-10-30", "Modification_Comment": "updated Potential_Mitigations"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2013-02-21", "Modification_Comment": "updated Name, Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2014-07-30", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2017-11-08", "Modification_Comment": "updated Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2019-01-03", "Modification_Comment": "updated References, Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2019-06-20", "Modification_Comment": "updated Relationships, Type"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-02-24", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-06-25", "Modification_Comment": "updated Demonstrative_Examples"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-08-20", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-12-10", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2021-03-15", "Modification_Comment": "updated Demonstrative_Examples, Observed_Examples, Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-01-31", "Modification_Comment": "updated Description"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated Detection_Factors, Relationships"}], "Previous_Entry_Name": {"@Date": "2013-02-21", "#text": "Missing Initialization"}}}