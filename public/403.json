{"@ID": "403", "@Name": "Exposure of File Descriptor to Unintended Control Sphere ('File Descriptor Leak')", "@Abstraction": "Base", "@Structure": "Simple", "@Status": "Draft", "Description": "A process does not close sensitive file descriptors before invoking a child process, which allows the child to perform unauthorized I/O operations using those descriptors.", "Extended_Description": "When a new process is forked or executed, the child process inherits any open file descriptors. When the child process has fewer privileges than the parent process, this might introduce a vulnerability if the child process can access the file descriptor but does not have the privileges to access the associated file.", "Related_Weaknesses": {"Related_Weakness": {"@Nature": "ChildOf", "@CWE_ID": "402", "@View_ID": "1000", "@Ordinal": "Primary"}}, "Applicable_Platforms": {"Language": {"@Class": "Not Language-Specific", "@Prevalence": "Undetermined"}, "Operating_System": {"@Class": "Unix", "@Prevalence": "Undetermined"}}, "Alternate_Terms": {"Alternate_Term": {"Term": "File descriptor leak", "Description": "While this issue is frequently called a file descriptor leak, the \"leak\" term is often used in two different ways - exposure of a resource, or consumption of a resource. Use of this term could cause confusion."}}, "Modes_Of_Introduction": {"Introduction": {"Phase": "Implementation", "Note": "REALIZATION: This weakness is caused during implementation of an architectural security tactic."}}, "Common_Consequences": {"Consequence": {"Scope": ["Confidentiality", "Integrity"], "Impact": ["Read Application Data", "Modify Application Data"]}}, "Observed_Examples": {"Observed_Example": [{"Reference": "CVE-2003-0740", "Description": "Server leaks a privileged file descriptor, allowing the server to be hijacked.", "Link": "https://www.cve.org/CVERecord?id=CVE-2003-0740"}, {"Reference": "CVE-2004-1033", "Description": "File descriptor leak allows read of restricted files.", "Link": "https://www.cve.org/CVERecord?id=CVE-2004-1033"}, {"Reference": "CVE-2000-0094", "Description": "Access to restricted resource using modified file descriptor for stderr.", "Link": "https://www.cve.org/CVERecord?id=CVE-2000-0094"}, {"Reference": "CVE-2002-0638", "Description": "Open file descriptor used as alternate channel in complex race condition.", "Link": "https://www.cve.org/CVERecord?id=CVE-2002-0638"}, {"Reference": "CVE-2003-0489", "Description": "Program does not fully drop privileges after creating a file descriptor, which allows access to the descriptor via a separate vulnerability.", "Link": "https://www.cve.org/CVERecord?id=CVE-2003-0489"}, {"Reference": "CVE-2003-0937", "Description": "User bypasses restrictions by obtaining a file descriptor then calling setuid program, which does not close the descriptor.", "Link": "https://www.cve.org/CVERecord?id=CVE-2003-0937"}, {"Reference": "CVE-2004-2215", "Description": "Terminal manager does not properly close file descriptors, allowing attackers to access terminals of other users.", "Link": "https://www.cve.org/CVERecord?id=CVE-2004-2215"}, {"Reference": "CVE-2006-5397", "Description": "Module opens a file for reading twice, allowing attackers to read files.", "Link": "https://www.cve.org/CVERecord?id=CVE-2006-5397"}]}, "Affected_Resources": {"Affected_Resource": ["System Process", "File or Directory"]}, "Taxonomy_Mappings": {"Taxonomy_Mapping": [{"@Taxonomy_Name": "PLOVER", "Entry_Name": "UNIX file descriptor leak"}, {"@Taxonomy_Name": "CERT C Secure Coding", "Entry_ID": "FIO42-C", "Entry_Name": "Ensure files are properly closed when they are no longer needed"}, {"@Taxonomy_Name": "Software Fault Patterns", "Entry_ID": "SFP23", "Entry_Name": "Exposed Data"}]}, "References": {"Reference": [{"@External_Reference_ID": "REF-392"}, {"@External_Reference_ID": "REF-393", "@Section": "Elevating Privileges Safely"}]}, "Content_History": {"Submission": {"Submission_Name": "PLOVER", "Submission_Date": "2006-07-19"}, "Modification": [{"Modification_Name": "Eric Dalci", "Modification_Organization": "Cigital", "Modification_Date": "2008-07-01", "Modification_Comment": "updated Time_of_Introduction"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2008-09-08", "Modification_Comment": "updated Applicable_Platforms, Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2008-11-24", "Modification_Comment": "updated Affected_Resources, Observed_Examples, Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-03-29", "Modification_Comment": "updated Name"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-06-01", "Modification_Comment": "updated Common_Consequences"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-06-27", "Modification_Comment": "updated Common_Consequences"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-09-13", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-05-11", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2013-02-21", "Modification_Comment": "updated Alternate_Terms, Description, Name, Observed_Examples, References"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2014-07-30", "Modification_Comment": "updated Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2017-11-08", "Modification_Comment": "updated Affected_Resources, Applicable_Platforms, Modes_of_Introduction, References, Relationships, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-02-24", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated References, Relationships, Time_of_Introduction"}], "Previous_Entry_Name": [{"@Date": "2011-03-29", "#text": "UNIX File Descriptor Leak"}, {"@Date": "2013-02-21", "#text": "Exposure of File Descriptor to Unintended Control Sphere"}]}}