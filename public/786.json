{"@ID": "786", "@Name": "Access of Memory Location Before Start of Buffer", "@Abstraction": "Base", "@Structure": "Simple", "@Status": "Incomplete", "Description": "The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer.", "Extended_Description": "This typically occurs when a pointer or its index is decremented to a position before the buffer, when pointer arithmetic results in a position before the beginning of the valid memory location, or when a negative index is used.", "Related_Weaknesses": {"Related_Weakness": [{"@Nature": "ChildOf", "@CWE_ID": "119", "@View_ID": "1000", "@Ordinal": "Primary"}, {"@Nature": "ChildOf", "@CWE_ID": "119", "@View_ID": "1305", "@Ordinal": "Primary"}, {"@Nature": "ChildOf", "@CWE_ID": "119", "@View_ID": "1340", "@Ordinal": "Primary"}]}, "Common_Consequences": {"Consequence": [{"Scope": "Confidentiality", "Impact": "Read Memory", "Note": "For an out-of-bounds read, the attacker may have access to sensitive information. If the sensitive information contains system details, such as the current buffers position in memory, this knowledge can be used to craft further attacks, possibly with more severe consequences."}, {"Scope": ["Integrity", "Availability"], "Impact": ["Modify Memory", "DoS: Crash, Exit, or Restart"], "Note": "Out of bounds memory access will very likely result in the corruption of relevant memory, and perhaps instructions, possibly leading to a crash."}, {"Scope": "Integrity", "Impact": ["Modify Memory", "Execute Unauthorized Code or Commands"], "Note": "If the corrupted memory can be effectively controlled, it may be possible to execute arbitrary code. If the corrupted memory is data rather than instructions, the system will continue to function with improper changes, possibly in violation of an implicit or explicit policy."}]}, "Detection_Methods": {"Detection_Method": {"@Detection_Method_ID": "DM-13", "Method": "Fuzzing", "Description": "Fuzz testing (fuzzing) is a powerful technique for generating large numbers of diverse inputs - either randomly or algorithmically - and dynamically invoking the code with those inputs. Even with random inputs, it is often capable of generating unexpected results such as crashes, memory corruption, or resource consumption. Fuzzing effectively produces repeatable test cases that clearly indicate bugs, which helps developers to diagnose the issues.", "Effectiveness": "High"}}, "Demonstrative_Examples": {"Demonstrative_Example": [{"@Demonstrative_Example_ID": "DX-87", "Intro_Text": "In the following C/C++ example, a utility function is used to trim trailing whitespace from a character string. The function copies the input string to a local character string and uses a while statement to remove the trailing whitespace by moving backward through the string and overwriting whitespace with a NUL character.", "Example_Code": {"@Nature": "Bad", "@Language": "C", "xhtml:div": {"xhtml:div": {"@style": "margin-left:1em;", "xhtml:div": {"xhtml:br": [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null], "xhtml:i": ["// copy input string to a temporary string", "// trim trailing whitespace", "// return string without trailing whitespace"], "xhtml:div": [{"@style": "margin-left:1em;", "#text": "message[index] = strMessage[index];"}, {"@style": "margin-left:1em;", "xhtml:br": null, "#text": "message[len] = '\\0';len--;"}], "#text": "char *retMessage;char *message = malloc(sizeof(char)*(length+1));\n                           \n                           \n                           char message[length+1];int index;for (index = 0; index < length; index++) {}message[index] = '\\0';\n                           \n                           \n                           int len = index-1;while (isspace(message[len])) {}\n                           \n                           \n                           retMessage = message;return retMessage;"}}, "#text": "char* trimTrailingWhitespace(char *strMessage, int length) {}"}}, "Body_Text": "However, this function can cause a buffer underwrite if the input character string contains all whitespace. On some systems the while statement will move backwards past the beginning of a character string and will call the isspace() function on an address outside of the bounds of the local buffer."}, {"@Demonstrative_Example_ID": "DX-90", "Intro_Text": "The following example asks a user for an offset into an array to select an item.", "Example_Code": {"@Nature": "Bad", "@Language": "C", "xhtml:div": {"xhtml:br": null, "xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null], "#text": "char *items[] = {\"boat\", \"car\", \"truck\", \"train\"};int index = GetUntrustedOffset();printf(\"You selected %s\\n\", items[index-1]);"}, "#text": "int main (int argc, char **argv) {}"}}, "Body_Text": "The programmer allows the user to specify which element in the list to select, however an attacker can provide an out-of-bounds offset, resulting in a buffer over-read (CWE-126)."}, {"@Demonstrative_Example_ID": "DX-88", "Intro_Text": "The following is an example of code that may result in a buffer underwrite, if find() returns a negative value to indicate that ch is not found in srcBuf:", "Example_Code": {"@Nature": "Bad", "@Language": "C", "xhtml:div": {"xhtml:div": {"@style": "margin-left:1em;", "xhtml:br": [null, null], "#text": "...strncpy(destBuf, &srcBuf[find(srcBuf, ch)], 1024);..."}, "#text": "int main() {}"}}, "Body_Text": "If the index to srcBuf is somehow under user control, this is an arbitrary write-what-where condition."}]}, "Observed_Examples": {"Observed_Example": [{"Reference": "CVE-2002-2227", "Description": "Unchecked length of SSLv2 challenge value leads to buffer underflow.", "Link": "https://www.cve.org/CVERecord?id=CVE-2002-2227"}, {"Reference": "CVE-2007-4580", "Description": "Buffer underflow from a small size value with a large buffer (length parameter inconsistency, CWE-130)", "Link": "https://www.cve.org/CVERecord?id=CVE-2007-4580"}, {"Reference": "CVE-2007-1584", "Description": "Buffer underflow from an all-whitespace string, which causes a counter to be decremented before the buffer while looking for a non-whitespace character.", "Link": "https://www.cve.org/CVERecord?id=CVE-2007-1584"}, {"Reference": "CVE-2007-0886", "Description": "Buffer underflow resultant from encoded data that triggers an integer overflow.", "Link": "https://www.cve.org/CVERecord?id=CVE-2007-0886"}, {"Reference": "CVE-2006-6171", "Description": "Product sets an incorrect buffer size limit, leading to \"off-by-two\" buffer underflow.", "Link": "https://www.cve.org/CVERecord?id=CVE-2006-6171"}, {"Reference": "CVE-2006-4024", "Description": "Negative value is used in a memcpy() operation, leading to buffer underflow.", "Link": "https://www.cve.org/CVERecord?id=CVE-2006-4024"}, {"Reference": "CVE-2004-2620", "Description": "Buffer underflow due to mishandled special characters", "Link": "https://www.cve.org/CVERecord?id=CVE-2004-2620"}]}, "Taxonomy_Mappings": {"Taxonomy_Mapping": {"@Taxonomy_Name": "CERT C Secure Coding", "Entry_ID": "ARR30-C", "Entry_Name": "Do not form or use out-of-bounds pointers or array subscripts", "Mapping_Fit": "CWE More Specific"}}, "Content_History": {"Submission": {"Submission_Name": "CWE Content Team", "Submission_Organization": "MITRE", "Submission_Date": "2009-10-21"}, "Modification": [{"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2011-06-01", "Modification_Comment": "updated Common_Consequences"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2012-05-11", "Modification_Comment": "updated Common_Consequences, Demonstrative_Examples, Observed_Examples, Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2017-11-08", "Modification_Comment": "updated Common_Consequences, Demonstrative_Examples, Taxonomy_Mappings"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2019-01-03", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-02-24", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-08-20", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2020-12-10", "Modification_Comment": "updated Relationships"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-01-31", "Modification_Comment": "updated Description"}, {"Modification_Name": "CWE Content Team", "Modification_Organization": "MITRE", "Modification_Date": "2023-04-27", "Modification_Comment": "updated Detection_Factors, Relationships"}]}}